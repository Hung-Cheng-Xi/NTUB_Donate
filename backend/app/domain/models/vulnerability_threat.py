from datetime import datetime
from sqlmodel import SQLModel, Field
from typing import Optional


class vulnerabilityThreat(SQLModel, table=True):
    """Represents a vulnerability threat.

    Attributes:
        id (Optional[int]): 自動遞增的主鍵。
        vulnerability_name (str): 弱點名稱。
        threat_type (Optional[str]):  威脅類型。
        default_severity (Optional[int]): 預設嚴重度，限制範圍 1-5。
        assessment_criteria (Optional[str]): 評估標準。
        cia_confidentiality (bool): 機密性 (CIA) 屬性。
        cia_integrity (bool): 完整性 (CIA) 屬性。
        cia_availability (bool): 可用性 (CIA) 屬性。
        created_at (Optional[datetime]): 建立時間。
        updated_at (Optional[datetime]): 更新時間。
    """
    id: Optional[int] = Field(default=None, primary_key=True)
    vulnerability_name: str = Field(max_length=255)
    threat_type: Optional[str] = Field(max_length=100)
    default_severity: Optional[int] = Field(ge=1, le=5)
    assessment_criteria: Optional[str]
    cia_confidentiality: bool = Field(default=False)
    cia_integrity: bool = Field(default=False)
    cia_availability: bool = Field(default=False)
    created_at: Optional[datetime] = Field(
        default_factory=datetime.utcnow)
    updated_at: Optional[datetime] = Field(
        default_factory=datetime.utcnow)

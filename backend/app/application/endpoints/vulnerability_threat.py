from typing import List
from fastapi import APIRouter, Depends
from sqlmodel import Session
from app.core.database import get_db

from app.domain.models.vulnerability_threat import vulnerabilityThreat
from app.infrastructure.repositories.vulnerability_threat import VulnerabilityThreatRepository

router = APIRouter(
    prefix="/vulnerability_threats",
    tags=["Vulnerability Threats"]
)


@router.get("/", response_model=List[vulnerabilityThreat])
async def read_vulnerability_threats(db: Session = Depends(get_db)):
    vulnerability_threat_repo = VulnerabilityThreatRepository(db)
    return vulnerability_threat_repo.get_all_vulnerability_threats()
